<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ù–∞–π–¥–∏ –∏–º—è –∫ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ (–ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –≤–µ—Ä—Å–∏—è)</title>
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Tailwind CSS –¥–ª—è —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —à—Ä–∏—Ñ—Ç–∞ Inter –∏–∑ Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç–∏–ª–∏ –∏ –∫–∞—Å—Ç–æ–º–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏ */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ */
        @keyframes shake {
            0%, 100% { transform: translateX(0) scale(1.03); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px) scale(1.03); }
            20%, 40%, 60%, 80% { transform: translateX(5px) scale(1.03); }
        }
        .shake {
            animation: shake 0.6s ease-in-out;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ */
        @keyframes correct-match {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(0.8); opacity: 0; }
        }
        .matched {
            animation: correct-match 0.5s forwards;
        }

        /* –°—Ç–∏–ª—å –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ */
        .selected {
            border-color: #3b82f6; /* –Ø—Ä–∫–∏–π —Å–∏–Ω–∏–π */
            transform: scale(1.03);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
    </style>
</head>
<body class="bg-gray-100 flex flex-col items-center min-h-screen p-4 sm:p-6">

    <div class="w-full max-w-6xl mx-auto">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ -->
        <div class="text-center mb-6">
            <h1 class="text-3xl sm:text-4xl font-bold text-gray-800">–£–≥–∞–¥–∞–π, –∫—Ç–æ –Ω–∞ —Ñ–æ—Ç–æ</h1>
            <p id="instruction" class="text-gray-600 mt-2">–ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Ñ–æ—Ç–æ, —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å.</p>
            <div id="progress" class="mt-4 text-lg font-medium text-gray-700"></div>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏–≥—Ä—ã -->
        <div id="gameWrap" class="flex flex-col lg:flex-row gap-6 lg:gap-8">
            <!-- –°–µ—Ç–∫–∞ —Å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏ -->
            <div id="photos" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-3 xl:grid-cols-4 gap-4 flex-grow">
                <!-- –ö–∞—Ä—Ç–æ—á–∫–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –∑–¥–µ—Å—å —Å –ø–æ–º–æ—â—å—é JS -->
            </div>

            <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å —Å –∏–º–µ–Ω–∞–º–∏ (–≤–∏–¥–Ω–∞ –Ω–∞ –±–æ–ª—å—à–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö) -->
            <div id="panel" class="w-full lg:w-64 lg:min-w-[256px] bg-white rounded-xl shadow-md p-4 self-start hidden lg:block">
                <h3 class="font-bold text-lg mb-4 text-gray-800 text-center">–ò–º–µ–Ω–∞</h3>
                <div id="names-desktop" class="space-y-2 max-h-[60vh] overflow-y-auto pr-2">
                    <!-- –ò–º–µ–Ω–∞ –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞ -->
                </div>
            </div>
        </div>

        <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –∏ –∫–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ -->
        <div id="message-container" class="text-center mt-6 min-h-[60px]">
            <p id="message" class="text-xl font-semibold transition-all duration-300"></p>
            <button id="restart-btn" class="hidden mt-4 px-6 py-2 bg-blue-500 text-white font-semibold rounded-lg shadow-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-opacity-75 transition-all">
                –ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞
            </button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –∏–º–µ–Ω–∞–º–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ -->
    <div id="names-modal" class="fixed inset-0 bg-black bg-opacity-60 hidden items-center justify-center p-4 z-50">
        <div class="bg-white rounded-xl shadow-lg w-full max-w-sm max-h-[80vh] flex flex-col">
            <h3 class="font-bold text-lg p-4 border-b text-center text-gray-800">–í—ã–±–µ—Ä–∏—Ç–µ –∏–º—è</h3>
            <div id="names-modal-list" class="space-y-2 overflow-y-auto p-4">
                <!-- –ò–º–µ–Ω–∞ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ -->
            </div>
            <button id="close-modal-btn" class="p-4 border-t text-gray-600 hover:bg-gray-100 transition-colors">
                –ó–∞–∫—Ä—ã—Ç—å
            </button>
        </div>
    </div>


<script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- –ù–ê–°–¢–†–û–ô–ö–ò –ò –î–ê–ù–ù–´–ï ---
        const inputFolder = 'input_photos';
        const imageFilenames = [
            "–Æ—Ä–∞ –ì–∞–ª–∏—à–Ω–∏–∫–æ–≤.jpeg","–Æ–ª—è –¶—É—Ä–∫–∞–Ω.jpeg","–Æ–ª—è –ö–ª–∞–ø–∞—Ç—é–∫.jpeg","–°–µ—Ä–µ–∂–∞ –ì—Ä–∏–≥–æ—Ä—å–µ–≤.jpeg","–†–æ–º–∞ –Ø–Ω—Ü–µ—Ä.jpeg","–ü–æ–ª–∏–Ω–∞ –î–æ–≤–Ω–æ—Ä–æ–≤–∏—á.jpeg","–ù–∏–∫–∏—Ç–∞ –§–∏–ª–∏–ø–ø–æ–≤.jpeg","–ù–∞—Ç–∞—à–∞ –ö—É—Ç—É–∫–æ–≤–∞.jpeg","–ù–∞—Å—Ç—è –ö–∞–Ω–µ–≤–∞.jpeg","–ù–∞—Å—Ç—è –ê–Ω–æ—Å–æ–≤–∞.jpeg","–ú–∞—à–∞ –•–∞—Ä–ª–∞–º–æ–≤–∞.jpeg","–ú–∞—à–∞ –û–≤—á–∏–Ω–Ω–∏–∫–æ–≤–∞.jpeg","–ú–∞–∫—Å–∏–º –ú–∞—Ç–∏–µ–Ω–∫–æ.jpeg","–ú–∞–∫—Å–∏–º –ê—Ä—Ç—ë–º–æ–≤.jpeg","–õ—é–±–∞–≤–∞ –ö–∞—à–∏–Ω–∞.jpeg","–ö—Å—é—à–∞ –ö—É—Ä–¥–∑—é–∫.jpeg","–ö—Ä–∏—Å—Ç–∏–Ω–∞ –§–∏–ª–∏–ø–ø–æ–≤–∞.jpeg","–ö—Ä–∏—Å—Ç–∏–Ω–∞ –§–∏–ª–∏–º–æ–Ω–æ–≤–∞.jpeg","–ö–∏—Ä–∏–ª–ª –°—É—Ö–æ–≤.jpeg","–ò–ª—å—è –õ–∞–∑–∞—Ä–µ–≤.jpeg","–ï–≤–∞ –£—Å—Ç—é–≥–æ–≤–∞.jpeg","–î–∞—à–∞ –î–æ—Ä–æ–Ω–∏–Ω–∞.jpeg","–î–∞–Ω—è –ê–ª–µ–ø–µ–Ω–∫–æ–≤.jpeg","–ì—É–∑—è –ì–∏–ª—å–º—É—Ç–¥–∏–Ω–æ–≤–∞.jpeg","–í–∏–∫–∞ –ò–Ω—å–∫–æ–≤–∞.jpeg","–ê—Ä–∏—à–∞ –ü–∞–Ω—á—É–ª.jpeg","–ê–ª—ë–Ω–∞ –¢—Ä–µ—Ç—å—è–∫–æ–≤–∞.jpeg"
        ];
        
        let people = [];
        let totalPeople = 0;
        let matchedCount = 0;
        let selectedPhotoCard = null;

        // --- DOM –≠–õ–ï–ú–ï–ù–¢–´ ---
        const photosEl = document.getElementById('photos');
        const namesDesktopEl = document.getElementById('names-desktop');
        const namesModalListEl = document.getElementById('names-modal-list');
        const namesModal = document.getElementById('names-modal');
        const closeModalBtn = document.getElementById('close-modal-btn');
        const msgEl = document.getElementById('message');
        const progressEl = document.getElementById('progress');
        const restartBtn = document.getElementById('restart-btn');
        const instructionEl = document.getElementById('instruction');

        // --- –§–£–ù–ö–¶–ò–ò ---

        const surnameSort = (a, b) => {
            const surnameA = a.name.split(' ')[1] || '';
            const surnameB = b.name.split(' ')[1] || '';
            return surnameA.localeCompare(surnameB, 'ru');
        };

        const shuffleArray = (array) => {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        };
        
        const updateProgress = () => {
            progressEl.textContent = `–ù–∞–π–¥–µ–Ω–æ –ø–∞—Ä: ${matchedCount} –∏–∑ ${totalPeople}`;
        };
        
        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–º—ë–Ω (–∏ –≤ –ø–∞–Ω–µ–ª–∏, –∏ –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ)
        const renderNames = () => {
            namesDesktopEl.innerHTML = '';
            namesModalListEl.innerHTML = '';

            const remainingPeople = people.filter(p => !p.matched).sort(surnameSort);

            remainingPeople.forEach(person => {
                const nameDiv = document.createElement('div');
                nameDiv.textContent = person.name;
                nameDiv.className = 'nameItem p-2.5 bg-gray-100 rounded-lg cursor-pointer hover:bg-gray-200 transition-colors duration-200 text-center';
                nameDiv.addEventListener('click', () => handleNameClick(person.name));
                
                // –ö–ª–æ–Ω–∏—Ä—É–µ–º —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ —Å–ø–∏—Å–∫–∞
                namesDesktopEl.appendChild(nameDiv);
                namesModalListEl.appendChild(nameDiv.cloneNode(true))
                                .addEventListener('click', () => handleNameClick(person.name));
            });
        };

        const renderPhotos = () => {
            photosEl.innerHTML = '';
            const shuffledPeople = [...people];
            shuffleArray(shuffledPeople);

            shuffledPeople.forEach(person => {
                const card = document.createElement('div');
                card.className = 'card bg-white rounded-xl shadow-sm border-2 border-transparent transition-all duration-200 cursor-pointer';
                card.dataset.name = person.name;
                card.addEventListener('click', () => handlePhotoClick(card));
                
                const img = new Image();
                img.src = `${inputFolder}/${person.name}.jpeg`;
                img.alt = `–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è ${person.name}`;
                img.className = 'w-full h-48 object-cover rounded-lg pointer-events-none';
                
                img.onerror = () => {
                    img.src = `https://placehold.co/150x200/e2e8f0/94a3b8?text=–§–æ—Ç–æ+–Ω–µ+–Ω–∞–π–¥–µ–Ω–æ`;
                    img.alt = `–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ ${person.name}`;
                };

                card.appendChild(img);
                photosEl.appendChild(card);
            });
        };

        // --- –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–ë–´–¢–ò–ô ---

        function handlePhotoClick(card) {
            // –°–Ω–∏–º–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π –∫–∞—Ä—Ç–æ—á–∫–∏
            if (selectedPhotoCard && selectedPhotoCard !== card) {
                selectedPhotoCard.classList.remove('selected');
            }

            // –í—ã–¥–µ–ª—è–µ–º –Ω–æ–≤—É—é –∫–∞—Ä—Ç–æ—á–∫—É
            card.classList.add('selected');
            selectedPhotoCard = card;
            instructionEl.textContent = `–í—ã–±—Ä–∞–Ω–æ —Ñ–æ—Ç–æ. –¢–µ–ø–µ—Ä—å –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∏–º—è.`;

            // –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –æ—Ç–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            if (window.innerWidth < 1024) {
                namesModal.classList.remove('hidden');
                namesModal.classList.add('flex');
            }
        }

        function handleNameClick(chosenName) {
            if (!selectedPhotoCard) {
                 msgEl.textContent = `–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é!`;
                 msgEl.className = 'text-xl font-semibold text-amber-600';
                 setTimeout(() => msgEl.textContent = '', 2000);
                 return;
            }

            const correctName = selectedPhotoCard.dataset.name;

            if (chosenName === correctName) {
                handleCorrectMatch(correctName);
            } else {
                handleWrongMatch();
            }

            // –°–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ
            if (window.innerWidth < 1024) {
                namesModal.classList.add('hidden');
                namesModal.classList.remove('flex');
            }
        }

        // --- –õ–û–ì–ò–ö–ê –†–ï–ó–£–õ–¨–¢–ê–¢–û–í ---

        const handleCorrectMatch = (correctName) => {
            msgEl.textContent = `‚úÖ –í–µ—Ä–Ω–æ! –≠—Ç–æ ${correctName}.`;
            msgEl.className = 'text-xl font-semibold text-green-600';
            
            const person = people.find(p => p.name === correctName);
            if (person) person.matched = true;

            selectedPhotoCard.classList.add('matched');
            
            matchedCount++;
            updateProgress();
            renderNames(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –∏–º—ë–Ω

            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é
            selectedPhotoCard = null;
            instructionEl.textContent = `–ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Ñ–æ—Ç–æ, —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å.`;

            if (matchedCount === totalPeople) {
                endGame();
            }
        };
        
        const handleWrongMatch = () => {
            msgEl.textContent = '‚ùå –ù–µ–≤–µ—Ä–Ω–æ, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.';
            msgEl.className = 'text-xl font-semibold text-red-600';
            selectedPhotoCard.classList.add('shake');

            selectedPhotoCard.addEventListener('animationend', () => {
                selectedPhotoCard.classList.remove('shake');
            }, { once: true });
        };

        const endGame = () => {
            msgEl.textContent = 'üéâ –û—Ç–ª–∏—á–Ω–æ! –í—ã –Ω–∞—à–ª–∏ –≤—Å–µ –ø–∞—Ä—ã!';
            msgEl.className = 'text-2xl font-bold text-blue-600';
            progressEl.textContent = `–†–µ–∑—É–ª—å—Ç–∞—Ç: ${totalPeople} –∏–∑ ${totalPeople}!`;
            instructionEl.textContent = '–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!';
            restartBtn.classList.remove('hidden');
        };
        
        const initGame = () => {
            people = imageFilenames.map(f => ({ name: f.replace(/\.jpe?g$/i, ''), matched: false }));
            totalPeople = people.length;
            matchedCount = 0;
            selectedPhotoCard = null;

            msgEl.textContent = '';
            instructionEl.textContent = '–ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Ñ–æ—Ç–æ, —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å.';
            restartBtn.classList.add('hidden');
            
            updateProgress();
            renderPhotos();
            renderNames();
        };

        // --- –°–õ–£–®–ê–¢–ï–õ–ò ---
        restartBtn.addEventListener('click', initGame);
        closeModalBtn.addEventListener('click', () => {
            namesModal.classList.add('hidden');
            namesModal.classList.remove('flex');
        });

        // –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫
        initGame();
    });
</script>
</body>
</html>
